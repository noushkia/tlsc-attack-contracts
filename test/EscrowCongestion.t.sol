// SPDX-License-Identifier: UNLICENSED

pragma solidity ^0.8.10;

import "forge-std/Test.sol";

import "../src/EscrowCongestion.sol";

contract EscrowCongestionTest is DSTest {
    EscrowCongestion public escrow;

    function setUp() public {
        escrow = new EscrowCongestion();
    }

    function testPartitionedEncoding() public {
        bytes[] memory pre_root = new bytes[](4);
        pre_root[0] = "0xf9021ea00c9ef41f038aa58a4aa2810fda03d9d82aac9082c80283230fd74cb1";
        pre_root[1] = "0xcceb4b00a01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142";
        pre_root[2] = "0xfd40d4934794ea674fdde714fd979de3edf0f56aa9716b898ec8a0fb3df73e7a";
        pre_root[3] = "0x41d500a374ee236dd613bb24f1a5fa5b80615a7953ea75c26c6a6da0";

        bytes[] memory post_root = new bytes[](13);
        post_root[0] = "0xa0f7b9f8e92a4b420a27302ab91084e5499d3d711183a021f4956ff32de246e1";
        post_root[1] = "0x4eb90100083815041300081040f485088003de10046040491c3c0164189830ca";
        post_root[2] = "0x3c2c0d1121040493008ba600924849820c8901130b0084038802610706000b61";
        post_root[3] = "0x01b220d01210000400020b08480850880d0226a04024e1070051145134100210";
        post_root[4] = "0x80080451126063400a1084021c62bc08290008a0430081540c892545360c4014";
        post_root[5] = "0x10194021426103228249162800ac016601100d0520b96203432080086a00424d";
        post_root[6] = "0x8214010b63180471318634d0ae00108041a1184488a10841a2610e0401e9001a";
        post_root[7] = "0x504a4010098182020808155027009c02008e56070c28728114480490400801ca";
        post_root[8] = "0xc010290ae291a00ca0408b60204c128012601c100a24cc01e100897242832a82";
        post_root[9] = "0x5000c1e1872bc1dd80f1e41183d59f808401caa841837be6128461e0aeeb9661";
        post_root[10] = "0x75737472616c69612d736f75746865617374312d31a0a832679fcf3e71f0b29b";
        post_root[11] = "0xd5913955151be5bf1fc59e135e3c7eb6e30f8442a5df8831e7e99df18e042485";
        post_root[12] = "0x207d533808";

        // ["0xf9021ea00c9ef41f038aa58a4aa2810fda03d9d82aac9082c80283230fd74cb1", "0xcceb4b00a01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142", "0xfd40d4934794ea674fdde714fd979de3edf0f56aa9716b898ec8a0fb3df73e7a", "0x41d500a374ee236dd613bb24f1a5fa5b80615a7953ea75c26c6a6da0"], ["0xa0f7b9f8e92a4b420a27302ab91084e5499d3d711183a021f4956ff32de246e1", "0x4eb90100083815041300081040f485088003de10046040491c3c0164189830ca", "0x3c2c0d1121040493008ba600924849820c8901130b0084038802610706000b61", "0x01b220d01210000400020b08480850880d0226a04024e1070051145134100210",  "0x80080451126063400a1084021c62bc08290008a0430081540c892545360c4014", "0x10194021426103228249162800ac016601100d0520b96203432080086a00424d", "0x8214010b63180471318634d0ae00108041a1184488a10841a2610e0401e9001a", "0x504a4010098182020808155027009c02008e56070c28728114480490400801ca", "0xc010290ae291a00ca0408b60204c128012601c100a24cc01e100897242832a82", "0x5000c1e1872bc1dd80f1e41183d59f808401caa841837be6128461e0aeeb9661", "0x75737472616c69612d736f75746865617374312d31a0a832679fcf3e71f0b29b", "0xd5913955151be5bf1fc59e135e3c7eb6e30f8442a5df8831e7e99df18e042485", "0x207d533808"]

        bytes32 hash = escrow.verifyEncoding(
            pre_root,
            post_root
        );

        assertEq(0x9bff49171de27924fa958faf7b7ce605c1ff0fdee86f4c0c74239e6ae20d9446, hash);
    }
}
